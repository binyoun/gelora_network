<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Mycelium Network</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Courier New', monospace;
            background: #000;
        }
        
        #ui-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }
        
        #intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            pointer-events: all;
            color: white;
            text-align: center;
            padding: 20px;
        }
        
        #intro-screen h1 {
            font-size: 2em;
            margin-bottom: 30px;
            letter-spacing: 3px;
        }
        
        #intro-screen p {
            font-size: 1.1em;
            line-spacing: 1.6;
            max-width: 400px;
            margin: 15px 0;
        }
        
        #start-button {
            margin-top: 40px;
            padding: 15px 40px;
            font-size: 1.2em;
            background: transparent;
            border: 2px solid white;
            color: white;
            cursor: pointer;
            letter-spacing: 2px;
            transition: all 0.3s;
        }
        
        #start-button:hover {
            background: white;
            color: black;
        }
        
        .touch-zone {
            position: absolute;
            width: 80px;
            height: 80px;
            pointer-events: all;
            cursor: pointer;
        }
        
        .touch-point {
            position: absolute;
            width: 40px;
            height: 40px;
            border: 2px solid rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.4s ease;
            backdrop-filter: blur(5px);
        }
        
        .touch-point::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: pulse 2s infinite;
        }
        
        .touch-point.touched {
            width: 60px;
            height: 60px;
            border-color: rgba(255, 255, 255, 1);
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
        }
        
        .touch-point.touched::before {
            width: 12px;
            height: 12px;
            animation: pulse-active 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { 
                opacity: 0.6;
                transform: translate(-50%, -50%) scale(1);
            }
            50% { 
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.3);
            }
        }
        
        @keyframes pulse-active {
            0%, 100% { 
                opacity: 0.8;
                transform: translate(-50%, -50%) scale(1);
            }
            50% { 
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.5);
            }
        }
        
        .mycelium-thread {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.4), 
                transparent);
            transform-origin: left center;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .mycelium-thread.active {
            opacity: 1;
            animation: flow 2s linear infinite;
        }
        
        @keyframes flow {
            0% { background-position: 0% 0%; }
            100% { background-position: 100% 0%; }
        }
        
        #status {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 1.2em;
            text-align: center;
            pointer-events: none;
            letter-spacing: 2px;
        }
        
        #counter {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 1.5em;
            pointer-events: none;
            letter-spacing: 3px;
        }
    </style>
</head>
<body>
    <!-- Intro Screen -->
    <div id="intro-screen">
        <h1>MYCELIUM NETWORK</h1>
        <p>You are the substrate</p>
        <p>Touch to awaken the network</p>
        <p>Connect all nodes</p>
        <button id="start-button">BEGIN</button>
    </div>

    <!-- UI Overlay -->
    <div id="ui-overlay">
        <div id="status">Touch to grow the network</div>
        <div id="counter">0/8</div>
        <div id="threads-container"></div>
        
        <!-- Touch zones positioned around screen -->
        <div class="touch-zone" style="top: 15%; left: 50%; transform: translateX(-50%);">
            <div class="touch-point" data-model="0"></div>
        </div>
        <div class="touch-zone" style="top: 35%; right: 10%;">
            <div class="touch-point" data-model="1"></div>
        </div>
        <div class="touch-zone" style="top: 50%; right: 5%;">
            <div class="touch-point" data-model="2"></div>
        </div>
        <div class="touch-zone" style="bottom: 25%; right: 15%;">
            <div class="touch-point" data-model="3"></div>
        </div>
        <div class="touch-zone" style="bottom: 15%; left: 50%; transform: translateX(-50%);">
            <div class="touch-point" data-model="4"></div>
        </div>
        <div class="touch-zone" style="bottom: 25%; left: 15%;">
            <div class="touch-point" data-model="5"></div>
        </div>
        <div class="touch-zone" style="top: 50%; left: 5%;">
            <div class="touch-point" data-model="6"></div>
        </div>
        <div class="touch-zone" style="top: 35%; left: 10%;">
            <div class="touch-point" data-model="7"></div>
        </div>
    </div>

    <!-- A-Frame Scene -->
    <a-scene 
        embedded 
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false">
        
        <!-- Camera -->
        <a-entity id="camera" camera position="0 0 0" look-controls="enabled: false"></a-entity>
        
        <!-- Assets -->
        <a-assets>
            <!-- Replace these with your actual GLB model paths -->
            <a-asset-item id="model0" src="models/model1.glb"></a-asset-item>
            <a-asset-item id="model1" src="models/model2.glb"></a-asset-item>
            <a-asset-item id="model2" src="models/model3.glb"></a-asset-item>
            <a-asset-item id="model3" src="models/model4.glb"></a-asset-item>
            <a-asset-item id="model4" src="models/model5.glb"></a-asset-item>
            <a-asset-item id="model5" src="models/model6.glb"></a-asset-item>
            <a-asset-item id="model6" src="models/model7.glb"></a-asset-item>
            <a-asset-item id="model7" src="models/model8.glb"></a-asset-item>
        </a-assets>

        <!-- Container for all models -->
        <a-entity id="models-container"></a-entity>
    </a-scene>

    <script>
        let touchedCount = 0;
        const totalModels = 8;
        const models = [];
        
        // Model positions in 3D space (circular arrangement)
        const modelPositions = [
            { x: 0, y: 1.5, z: -3 },      // North (top)
            { x: 2, y: 0.8, z: -3 },      // Northeast
            { x: 2.5, y: 0, z: -3 },      // East (right)
            { x: 2, y: -1, z: -3 },       // Southeast
            { x: 0, y: -1.5, z: -3 },     // South (bottom)
            { x: -2, y: -1, z: -3 },      // Southwest
            { x: -2.5, y: 0, z: -3 },     // West (left)
            { x: -2, y: 0.8, z: -3 }      // Northwest
        ];

        // Start button
        document.getElementById('start-button').addEventListener('click', () => {
            document.getElementById('intro-screen').style.display = 'none';
        });

        // Touch interaction
        const touchPoints = document.querySelectorAll('.touch-point');
        const container = document.getElementById('models-container');
        const threadsContainer = document.getElementById('threads-container');
        
        touchPoints.forEach((point, index) => {
            point.parentElement.addEventListener('click', () => {
                if (!point.classList.contains('touched')) {
                    point.classList.add('touched');
                    touchedCount++;
                    
                    // Update counter
                    document.getElementById('counter').textContent = `${touchedCount}/8`;
                    
                    // Spawn model
                    spawnModel(index);
                    
                    // Update status
                    if (touchedCount === 1) {
                        document.getElementById('status').textContent = 'The network begins...';
                    } else if (touchedCount === totalModels) {
                        document.getElementById('status').textContent = 'Network complete';
                    } else {
                        document.getElementById('status').textContent = 'Growing...';
                    }
                    
                    // Create threads to other active points
                    updateThreads();
                }
            });
        });

        function spawnModel(index) {
            const pos = modelPositions[index];
            
            // Create model entity
            const model = document.createElement('a-entity');
            model.setAttribute('gltf-model', `#model${index}`);
            model.setAttribute('position', `${pos.x} ${pos.y} ${pos.z}`);
            model.setAttribute('scale', '0.01 0.01 0.01');
            
            // Growth animation
            model.setAttribute('animation', {
                property: 'scale',
                to: '0.5 0.5 0.5',
                dur: 2000,
                easing: 'easeOutElastic'
            });
            
            // Rotation animation
            model.setAttribute('animation__rotate', {
                property: 'rotation',
                to: '0 360 0',
                dur: 20000,
                loop: true,
                easing: 'linear'
            });
            
            // Floating animation
            model.setAttribute('animation__float', {
                property: 'position',
                to: `${pos.x} ${pos.y + 0.3} ${pos.z}`,
                dur: 3000,
                dir: 'alternate',
                loop: true,
                easing: 'easeInOutSine'
            });
            
            container.appendChild(model);
            models[index] = { element: model, position: pos };
        }

        function updateThreads() {
            // Clear existing threads
            threadsContainer.innerHTML = '';
            
            // Create threads between all touched points
            const touchedPoints = Array.from(touchPoints).filter(p => p.classList.contains('touched'));
            
            for (let i = 0; i < touchedPoints.length; i++) {
                for (let j = i + 1; j < touchedPoints.length; j++) {
                    createThread(touchedPoints[i], touchedPoints[j]);
                }
            }
        }

        function createThread(point1, point2) {
            const rect1 = point1.getBoundingClientRect();
            const rect2 = point2.getBoundingClientRect();
            
            const x1 = rect1.left + rect1.width / 2;
            const y1 = rect1.top + rect1.height / 2;
            const x2 = rect2.left + rect2.width / 2;
            const y2 = rect2.top + rect2.height / 2;
            
            const distance = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
            const angle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);
            
            const thread = document.createElement('div');
            thread.className = 'mycelium-thread';
            thread.style.width = distance + 'px';
            thread.style.left = x1 + 'px';
            thread.style.top = y1 + 'px';
            thread.style.transform = `rotate(${angle}deg)`;
            
            threadsContainer.appendChild(thread);
            
            // Activate with delay
            setTimeout(() => {
                thread.classList.add('active');
            }, 100);
        }

        // Update threads on window resize
        window.addEventListener('resize', () => {
            if (touchedCount > 1) {
                updateThreads();
            }
        });
    </script>
</body>
</html>
