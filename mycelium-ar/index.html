<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Mycelium Network AR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/three.js/build/ar-threex-location-only.js"></script>
    
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
        }
        
        .info {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-family: Arial;
            font-size: 14px;
            z-index: 999;
        }
    </style>
</head>
<body>
    <div class="info">Scan a marker to grow mycelium</div>
    
    <!-- Custom animations -->
    <script>
        AFRAME.registerComponent('fungi-growth', {
            schema: {
                duration: {default: 2000},
                finalScale: {default: 1}
            },
            
            init: function() {
                this.el.setAttribute('scale', '0.01 0.01 0.01');
                this.growing = false;
            },
            
            tick: function(time) {
                if (!this.growing && this.el.object3D.visible) {
                    this.startGrowth();
                }
                
                if (!this.el.object3D.visible) {
                    this.el.setAttribute('scale', '0.01 0.01 0.01');
                    this.growing = false;
                }
            },
            
            startGrowth: function() {
                this.growing = true;
                const finalScale = this.data.finalScale;
                
                // Organic growth animation
                this.el.setAttribute('animation__grow', {
                    property: 'scale',
                    from: '0.01 0.01 0.01',
                    to: `${finalScale} ${finalScale * 0.3} ${finalScale}`, // Starts flat
                    dur: this.data.duration * 0.4,
                    easing: 'easeOutQuad'
                });
                
                // Then expand vertically like fungi growing
                setTimeout(() => {
                    this.el.setAttribute('animation__expand', {
                        property: 'scale',
                        from: `${finalScale} ${finalScale * 0.3} ${finalScale}`,
                        to: `${finalScale} ${finalScale} ${finalScale}`,
                        dur: this.data.duration * 0.6,
                        easing: 'easeOutElastic'
                    });
                }, this.data.duration * 0.4);
            }
        });
        
        AFRAME.registerComponent('circular-motion', {
            schema: {
                radius: {default: 0.5},
                speed: {default: 0.5}
            },
            
            tick: function(time) {
                if (this.el.object3D.visible) {
                    const angle = (time / 1000) * this.data.speed;
                    const x = Math.sin(angle) * this.data.radius;
                    const z = Math.cos(angle) * this.data.radius;
                    
                    this.el.object3D.position.x = x;
                    this.el.object3D.position.z = z;
                    
                    // Gentle bobbing motion
                    this.el.object3D.position.y = Math.sin(angle * 2) * 0.1;
                    
                    // Rotate as it moves
                    this.el.object3D.rotation.y = angle;
                }
            }
        });
    </script>
    
    <a-scene
        embedded
        arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;">
        
        <!-- Model 1 -->
        <a-marker type="pattern" url="./markers/marker1.patt" smooth="true" smoothCount="10">
            <a-entity
                gltf-model="./models/model1.glb"
                scale="1 1 1"
                position="0 0 0"
                fungi-growth="duration: 3000; finalScale: 1"
                circular-motion="radius: 0.3; speed: 0.5"
                animation__pulse="property: scale; from: 1 1 1; to: 1.05 1.05 1.05; dur: 2000; loop: true; dir: alternate; startEvents: animationcomplete__expand">
            </a-entity>
        </a-marker>
        
        <!-- Model 2 -->
        <a-marker type="pattern" url="./markers/marker2.patt" smooth="true" smoothCount="10">
            <a-entity
                gltf-model="./models/model2.glb"
                scale="1 1 1"
                position="0 0 0"
                fungi-growth="duration: 2500; finalScale: 1.2"
                circular-motion="radius: 0.4; speed: 0.6">
            </a-entity>
        </a-marker>
        
        <!-- Model 3 -->
        <a-marker type="pattern" url="./markers/marker3.patt" smooth="true" smoothCount="10">
            <a-entity
                gltf-model="./models/model3.glb"
                scale="1 1 1"
                position="0 0 0"
                fungi-growth="duration: 3500; finalScale: 0.8"
                circular-motion="radius: 0.25; speed: 0.4">
            </a-entity>
        </a-marker>
        
        <!-- Model 4 -->
        <a-marker type="pattern" url="./markers/marker4.patt" smooth="true" smoothCount="10">
            <a-entity
                gltf-model="./models/model4.glb"
                scale="1 1 1"
                position="0 0 0"
                fungi-growth="duration: 2000; finalScale: 1.1"
                circular-motion="radius: 0.35; speed: 0.7">
            </a-entity>
        </a-marker>
        
        <!-- Model 5 -->
        <a-marker type="pattern" url="./markers/marker5.patt" smooth="true" smoothCount="10">
            <a-entity
                gltf-model="./models/model5.glb"
                scale="1 1 1"
                position="0 0 0"
                fungi-growth="duration: 4000; finalScale: 0.9"
                circular-motion="radius: 0.5; speed: 0.3">
            </a-entity>
        </a-marker>
        
        <!-- Model 6 -->
        <a-marker type="pattern" url="./markers/marker6.patt" smooth="true" smoothCount="10">
            <a-entity
                gltf-model="./models/model6.glb"
                scale="1 1 1"
                position="0 0 0"
                fungi-growth="duration: 2800; finalScale: 1.3"
                circular-motion="radius: 0.45; speed: 0.55">
            </a-entity>
        </a-marker>
        
        <!-- Model 7 -->
        <a-marker type="pattern" url="./markers/marker7.patt" smooth="true" smoothCount="10">
            <a-entity
                gltf-model="./models/model7.glb"
                scale="1 1 1"
                position="0 0 0"
                fungi-growth="duration: 3200; finalScale: 1"
                circular-motion="radius: 0.3; speed: 0.65">
            </a-entity>
        </a-marker>
        
        <!-- Model 8 -->
        <a-marker type="pattern" url="./markers/marker8.patt" smooth="true" smoothCount="10">
            <a-entity
                gltf-model="./models/model8.glb"
                scale="1 1 1"
                position="0 0 0"
                fungi-growth="duration: 3000; finalScale: 1.15"
                circular-motion="radius: 0.4; speed: 0.45">
            </a-entity>
        </a-marker>
        
        <a-entity camera></a-entity>
    </a-scene>
</body>
</html>
